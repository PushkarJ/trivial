class Vulnerability
  def initialize(data)
    @data = data
  end

  def severity
    severity = @data["Severity"].downcase
    return severity if severity != "critical"

    max_cvss_score = @data["CVSS"].inject(0) do |max_score, (source, score_data)|
      score = score_data["V3Score"] || 0
      max_score = [max_score, score].max
    end
    if max_cvss_score == 10
      "catastrophic"
    else
      "critical"
    end
  end
end

